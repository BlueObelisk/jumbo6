<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.5.0_04) on Fri Dec 01 14:22:37 GMT 2006 -->
<TITLE>
CMLFormula
</TITLE>

<META NAME="keywords" CONTENT="org.xmlcml.cml.element.CMLFormula class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="CMLFormula";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/CMLFormula.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/xmlcml/cml/element/CMLFor.html" title="class in org.xmlcml.cml.element"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.Sort.html" title="enum in org.xmlcml.cml.element"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?org/xmlcml/cml/element/CMLFormula.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="CMLFormula.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;<A HREF="#nested_class_summary">NESTED</A>&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.xmlcml.cml.element</FONT>
<BR>
Class CMLFormula</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../resources/inherit.gif" ALT="extended by ">nu.xom.Node
      <IMG SRC="../../../../resources/inherit.gif" ALT="extended by ">nu.xom.ParentNode
          <IMG SRC="../../../../resources/inherit.gif" ALT="extended by ">nu.xom.Element
              <IMG SRC="../../../../resources/inherit.gif" ALT="extended by "><A HREF="../../../../org/xmlcml/cml/base/CMLElement.html" title="class in org.xmlcml.cml.base">org.xmlcml.cml.base.CMLElement</A>
                  <IMG SRC="../../../../resources/inherit.gif" ALT="extended by "><A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html" title="class in org.xmlcml.cml.element">org.xmlcml.cml.element.AbstractFormula</A>
                      <IMG SRC="../../../../resources/inherit.gif" ALT="extended by "><B>org.xmlcml.cml.element.CMLFormula</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html" title="interface in org.xmlcml.cml.base">CMLConstants</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html" title="interface in org.xmlcml.euclid">EuclidConstants</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>CMLFormula</B><DT>extends <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html" title="class in org.xmlcml.cml.element">AbstractFormula</A></DL>
</PRE>

<P>
user-modifiable class supporting formula. * The semantics of formula have
 been updated (2005-10) and the relationship between concise attribute and
 atomArray children is explicit. This class supports the parsing of a number
 of current inline structures but does not guarantee correctness as there are
 no agreed community syntax/semantics. This is a particular problem for
 charges which could be "2+", "++", "+2", etc. For robust inline interchange
 ONLY the concise representation is supported.
 
 NOTE: The atomArray child, in array format, together with the formalCharge
 attribute is the primary means of holding the formula. There is now no lazy
 evaluation. The concise attribute can be autogenerated from the atomArray and
 formalCharge. If a formula is input with only concise then the atomArray is
 automatically generated from it.
<P>

<P>
<HR>

<P>
<!-- ======== NESTED CLASS SUMMARY ======== -->

<A NAME="nested_class_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Nested Class Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;class</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.Sort.html" title="enum in org.xmlcml.cml.element">CMLFormula.Sort</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort type</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;class</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.Type.html" title="enum in org.xmlcml.cml.element">CMLFormula.Type</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type</TD>
</TR>
</TABLE>
&nbsp;<A NAME="nested_classes_inherited_from_class_org.xmlcml.cml.base.CMLElement"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Nested classes/interfaces inherited from class org.xmlcml.cml.base.<A HREF="../../../../org/xmlcml/cml/base/CMLElement.html" title="class in org.xmlcml.cml.base">CMLElement</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../org/xmlcml/cml/base/CMLElement.CoordinateType.html" title="enum in org.xmlcml.cml.base">CMLElement.CoordinateType</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.FormalChargeControl.html" title="enum in org.xmlcml.cml.base">CMLElement.FormalChargeControl</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.Hybridization.html" title="enum in org.xmlcml.cml.base">CMLElement.Hybridization</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#NDEC">NDEC</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#NPLACES">NPLACES</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;<A NAME="fields_inherited_from_class_org.xmlcml.cml.element.AbstractFormula"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Fields inherited from class org.xmlcml.cml.element.<A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html" title="class in org.xmlcml.cml.element">AbstractFormula</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#attributeGroupNameTable">attributeGroupNameTable</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#TAG">TAG</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="fields_inherited_from_class_org.xmlcml.cml.base.CMLConstants"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Fields inherited from interface org.xmlcml.cml.base.<A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html" title="interface in org.xmlcml.cml.base">CMLConstants</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#_UNIT_NS">_UNIT_NS</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#ABSTRACT_NODEFACTORY">ABSTRACT_NODEFACTORY</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#ATTRIBUTE_LIST">ATTRIBUTE_LIST</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#ATTRIBUTES">ATTRIBUTES</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#AUTOGENERATED_DONOTEDIT_S">AUTOGENERATED_DONOTEDIT_S</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#BANNER_S">BANNER_S</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CATALOG_XML">CATALOG_XML</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CML">CML</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CML_DATATYPETYPE">CML_DATATYPETYPE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CML_DICT_NS">CML_DICT_NS</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CML_FILENAME">CML_FILENAME</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CML_NAMESPACEREFTYPE">CML_NAMESPACEREFTYPE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CML_NS">CML_NS</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CML_PREFIX">CML_PREFIX</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CML_SIUNITS">CML_SIUNITS</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CML_UNITS">CML_UNITS</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CML_UNITSTYPE">CML_UNITSTYPE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CML_XMLNS">CML_XMLNS</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CML_XMLNS_PREFIX">CML_XMLNS_PREFIX</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CML1">CML1</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CML2">CML2</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CML3">CML3</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_ANNOTATION">CMLXSD_ANNOTATION</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_ANY">CMLXSD_ANY</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_APPINFO">CMLXSD_APPINFO</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_ATTPREFIX">CMLXSD_ATTPREFIX</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_ATTRIBUTE">CMLXSD_ATTRIBUTE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_ATTRIBUTEGROUP">CMLXSD_ATTRIBUTEGROUP</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_BASE">CMLXSD_BASE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_CHOICE">CMLXSD_CHOICE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_COMPLEXTYPE">CMLXSD_COMPLEXTYPE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_DOCUMENTATION">CMLXSD_DOCUMENTATION</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_ELEMENT">CMLXSD_ELEMENT</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_ENUMERATION">CMLXSD_ENUMERATION</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_EXTENSION">CMLXSD_EXTENSION</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_ID">CMLXSD_ID</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_ITEMTYPE">CMLXSD_ITEMTYPE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_LENGTH">CMLXSD_LENGTH</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_LIST">CMLXSD_LIST</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_MAXEXCLUSIVE">CMLXSD_MAXEXCLUSIVE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_MAXINCLUSIVE">CMLXSD_MAXINCLUSIVE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_MINEXCLUSIVE">CMLXSD_MINEXCLUSIVE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_MININCLUSIVE">CMLXSD_MININCLUSIVE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_NAME">CMLXSD_NAME</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_PATTERN">CMLXSD_PATTERN</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_REF">CMLXSD_REF</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_RESTRICTION">CMLXSD_RESTRICTION</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_ROOT">CMLXSD_ROOT</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_SEQUENCE">CMLXSD_SEQUENCE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_SIMPLECONTENT">CMLXSD_SIMPLECONTENT</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_SIMPLETYPE">CMLXSD_SIMPLETYPE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_TEXT">CMLXSD_TEXT</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_TYPE">CMLXSD_TYPE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_UNBOUNDED">CMLXSD_UNBOUNDED</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_UNION">CMLXSD_UNION</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_VALUE">CMLXSD_VALUE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CMLXSD_XMLCONTENT">CMLXSD_XMLCONTENT</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CRYSTAL_DICT_REFS">CRYSTAL_DICT_REFS</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#CRYSTAL_DICT_UNITS">CRYSTAL_DICT_UNITS</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#DICT_NS">DICT_NS</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#DOUBLE">DOUBLE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#ELEMENT_LIST">ELEMENT_LIST</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#ELEMENTS">ELEMENTS</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#F_S">F_S</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#INTEGER">INTEGER</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#NDICT">NDICT</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#NUNIT_DICT">NUNIT_DICT</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#NUNIT_TYPE_DICT">NUNIT_TYPE_DICT</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#OLD_NAMESPACES">OLD_NAMESPACES</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#SIUNIT_NS">SIUNIT_NS</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#STRING">STRING</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#TEXT_LIST">TEXT_LIST</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#TYPE_LIST">TYPE_LIST</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#TYPES">TYPES</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#U_ANGSTROM">U_ANGSTROM</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#U_CELSIUS">U_CELSIUS</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#U_DEGREE">U_DEGREE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#U_KCAL">U_KCAL</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#U_S">U_S</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#UNIT_NS">UNIT_NS</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#UNITTYPES_NS">UNITTYPES_NS</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#WARNING_S">WARNING_S</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#X_CML">X_CML</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#XHTML_NS">XHTML_NS</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#XMLNS">XMLNS</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#XSD_ANYURI">XSD_ANYURI</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#XSD_BOOLEAN">XSD_BOOLEAN</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#XSD_DOUBLE">XSD_DOUBLE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#XSD_FLOAT">XSD_FLOAT</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#XSD_INTEGER">XSD_INTEGER</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#XSD_MAXEXCLUSIVE">XSD_MAXEXCLUSIVE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#XSD_MAXINCLUSIVE">XSD_MAXINCLUSIVE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#XSD_MINEXCLUSIVE">XSD_MINEXCLUSIVE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#XSD_MININCLUSIVE">XSD_MININCLUSIVE</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#XSD_NONNEGATIVEINTEGER">XSD_NONNEGATIVEINTEGER</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#XSD_NS">XSD_NS</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#XSD_POSITIVE_NUMBER">XSD_POSITIVE_NUMBER</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#XSD_POSITIVEINTEGER">XSD_POSITIVEINTEGER</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#XSD_PREFIX">XSD_PREFIX</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#XSD_QNAME">XSD_QNAME</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#XSD_STRING">XSD_STRING</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLConstants.html#XSD_XMLNS">XSD_XMLNS</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="fields_inherited_from_class_org.xmlcml.euclid.EuclidConstants"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Fields inherited from interface org.xmlcml.euclid.<A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html" title="interface in org.xmlcml.euclid">EuclidConstants</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_AMP">C_AMP</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_APOS">C_APOS</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_ATSIGN">C_ATSIGN</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_BACKSLASH">C_BACKSLASH</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_CARET">C_CARET</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_COLON">C_COLON</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_COMMA">C_COMMA</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_DOLLAR">C_DOLLAR</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_EQUALS">C_EQUALS</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_FORMFEED">C_FORMFEED</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_HASH">C_HASH</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_LANGLE">C_LANGLE</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_LBRAK">C_LBRAK</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_LCURLY">C_LCURLY</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_LSQUARE">C_LSQUARE</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_MINUS">C_MINUS</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_NEWLINE">C_NEWLINE</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_NL">C_NL</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_PERCENT">C_PERCENT</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_PERIOD">C_PERIOD</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_PIPE">C_PIPE</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_PLUS">C_PLUS</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_POUND">C_POUND</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_QUERY">C_QUERY</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_QUOT">C_QUOT</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_RANGLE">C_RANGLE</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_RBRAK">C_RBRAK</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_RCURLY">C_RCURLY</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_RETURN">C_RETURN</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_RSQUARE">C_RSQUARE</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_SEMICOLON">C_SEMICOLON</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_SHRIEK">C_SHRIEK</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_SLASH">C_SLASH</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_SPACE">C_SPACE</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_STAR">C_STAR</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_TAB">C_TAB</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_TILDE">C_TILDE</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#C_UNDER">C_UNDER</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#EPS">EPS</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#NONWHITEPUNC">NONWHITEPUNC</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#PUNC">PUNC</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_AMP">S_AMP</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_APOS">S_APOS</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_ATSIGN">S_ATSIGN</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_BACKSLASH">S_BACKSLASH</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_CARET">S_CARET</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_COLON">S_COLON</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_COMMA">S_COMMA</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_DOLLAR">S_DOLLAR</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_EMPTY">S_EMPTY</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_EQUALS">S_EQUALS</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_FORMFEED">S_FORMFEED</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_HASH">S_HASH</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_LANGLE">S_LANGLE</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_LBRAK">S_LBRAK</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_LCURLY">S_LCURLY</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_LSQUARE">S_LSQUARE</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_MINUS">S_MINUS</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_NEWLINE">S_NEWLINE</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_NL">S_NL</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_PERCENT">S_PERCENT</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_PERIOD">S_PERIOD</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_PIPE">S_PIPE</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_PLUS">S_PLUS</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_POUND">S_POUND</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_QUERY">S_QUERY</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_QUOT">S_QUOT</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_RANGLE">S_RANGLE</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_RBRAK">S_RBRAK</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_RCURLY">S_RCURLY</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_RETURN">S_RETURN</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_RSQUARE">S_RSQUARE</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_SEMICOLON">S_SEMICOLON</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_SHRIEK">S_SHRIEK</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_SLASH">S_SLASH</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_SPACE">S_SPACE</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_STAR">S_STAR</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_TAB">S_TAB</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_TILDE">S_TILDE</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_UNDER">S_UNDER</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#S_WHITEREGEX">S_WHITEREGEX</A>, <A HREF="../../../../org/xmlcml/euclid/EuclidConstants.html#WHITESPACE">WHITESPACE</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#CMLFormula()">CMLFormula</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normal constructor.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#CMLFormula(org.xmlcml.cml.element.CMLFormula)">CMLFormula</A></B>(<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A>&nbsp;old)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copy constructor.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#CMLFormula(org.xmlcml.cml.element.CMLMolecule)">CMLFormula</A></B>(<A HREF="../../../../org/xmlcml/cml/element/CMLMolecule.html" title="class in org.xmlcml.cml.element">CMLMolecule</A>&nbsp;molecule)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructor that creates a formula element using the atoms in a molecule.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#add(java.lang.String, double)">add</A></B>(java.lang.String&nbsp;elementType,
    double&nbsp;count)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds element and count to formula.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#addFormula(org.xmlcml.cml.element.CMLFormula)">addFormula</A></B>(<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A>&nbsp;f)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adds a child formula to the content.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#appendChild(nu.xom.Element)">appendChild</A></B>(nu.xom.Element&nbsp;child)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add child.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#checkAtomArrayFormat(org.xmlcml.cml.element.CMLAtomArray)">checkAtomArrayFormat</A></B>(<A HREF="../../../../org/xmlcml/cml/element/CMLAtomArray.html" title="class in org.xmlcml.cml.element">CMLAtomArray</A>&nbsp;atomArray)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checks that atomArray is in array format with unduplicated valid
 elements.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;nu.xom.Node</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#copy()">copy</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copy node .</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#createAggregatedFormula(org.xmlcml.cml.element.CMLFormula)">createAggregatedFormula</A></B>(<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A>&nbsp;form)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aggregates two formulae including charge.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#createFormula(java.lang.String)">createFormula</A></B>(java.lang.String&nbsp;s)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;create formula from string.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#createFormula(java.lang.String, org.xmlcml.cml.element.CMLFormula.Type)">createFormula</A></B>(java.lang.String&nbsp;s,
              <A HREF="../../../../org/xmlcml/cml/element/CMLFormula.Type.html" title="enum in org.xmlcml.cml.element">CMLFormula.Type</A>&nbsp;convention)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;create formula from string using convention.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#debug(java.io.Writer)">debug</A></B>(java.io.Writer&nbsp;w)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Output debug info to Writer.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#divideBy(org.xmlcml.cml.element.CMLFormula, double)">divideBy</A></B>(<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A>&nbsp;f,
         double&nbsp;eps)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;divide one formula by another.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#equals(org.xmlcml.cml.element.CMLFormula, double)">equals</A></B>(<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A>&nbsp;form,
       double&nbsp;eps)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tests equality of formulae.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#equalsAggregate(org.xmlcml.cml.element.CMLFormula)">equalsAggregate</A></B>(<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A>&nbsp;form)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;are two formulas equal.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#equalsConcise(org.xmlcml.cml.element.CMLFormula)">equalsConcise</A></B>(<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A>&nbsp;f)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;compares current concise strings.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#finishMakingElement(nu.xom.Element)">finishMakingElement</A></B>(nu.xom.Element&nbsp;parent)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shouldn't be necessary.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#generateConcise(org.xmlcml.cml.element.CMLAtomArray, int)">generateConcise</A></B>(<A HREF="../../../../org/xmlcml/cml/element/CMLAtomArray.html" title="class in org.xmlcml.cml.element">CMLAtomArray</A>&nbsp;atomArray,
                int&nbsp;formalCharge)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;generates concise representation.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#getAggregateFormula()">getAggregateFormula</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gets single formula representing all contents.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#getCalculatedMass(java.util.List, org.xmlcml.euclid.RealArray)">getCalculatedMass</A></B>(java.util.List&nbsp;elementTypeVector,
                  <A HREF="../../../../org/xmlcml/euclid/RealArray.html" title="class in org.xmlcml.euclid">RealArray</A>&nbsp;countArray)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calculate molecular mass from vector of element symbols and their counts.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#getCalculatedMolecularMass()">getCalculatedMolecularMass</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get calculated molecular mass.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#getConciseNoCharge()">getConciseNoCharge</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return concise formaul without trailing charge.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#getCount()">getCount</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gets count of formula.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;double[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#getCounts()">getCounts</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Count for corresponding element.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#getDifference(org.xmlcml.cml.element.CMLFormula)">getDifference</A></B>(<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A>&nbsp;form)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;difference between formulas.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#getElementTypes()">getElementTypes</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Count for corresponding element.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#getFormalCharge()">getFormalCharge</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gets the charge on the formula.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#getFormalChargeString()">getFormalChargeString</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;translates charge to an integer and then to String.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#getFormattedString()">getFormattedString</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default formula.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#getFormattedString(org.xmlcml.cml.element.CMLFormula.Type, org.xmlcml.cml.element.CMLFormula.Sort, boolean)">getFormattedString</A></B>(<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.Type.html" title="enum in org.xmlcml.cml.element">CMLFormula.Type</A>&nbsp;convention,
                   <A HREF="../../../../org/xmlcml/cml/element/CMLFormula.Sort.html" title="enum in org.xmlcml.cml.element">CMLFormula.Sort</A>&nbsp;sort,
                   boolean&nbsp;omitCount1)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get formatted formula.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#mainTest(java.lang.String[])">mainTest</A></B>(java.lang.String[]&nbsp;args)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#makeElementInContext(nu.xom.Element)">makeElementInContext</A></B>(nu.xom.Element&nbsp;parent)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;create new instance in context of parent, overridable by subclasses.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#multiplyBy(double)">multiplyBy</A></B>(double&nbsp;d)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;multiply all counts by the same constant factor.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#normalize()">normalize</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normalizes the formula.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#removeChargeFromConcise(java.lang.String)">removeChargeFromConcise</A></B>(java.lang.String&nbsp;s)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;removes optional charge field from concise formula.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#setConcise(java.lang.String)">setConcise</A></B>(java.lang.String&nbsp;value)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set concise attribute.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#setFormalCharge(int)">setFormalCharge</A></B>(int&nbsp;ch)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set formal charge.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#toFormulaString()">toFormulaString</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;create formula string.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html#writeHTML(java.io.Writer)">writeHTML</A></B>(java.io.Writer&nbsp;w)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output HTML.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_org.xmlcml.cml.element.AbstractFormula"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class org.xmlcml.cml.element.<A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html" title="class in org.xmlcml.cml.element">AbstractFormula</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#addAtomArray(org.xmlcml.cml.element.AbstractAtomArray)">addAtomArray</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#addAttribute(nu.xom.Attribute)">addAttribute</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#addFormula(org.xmlcml.cml.element.AbstractFormula)">addFormula</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#getAtomArrayElements()">getAtomArrayElements</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#getAttributeGroupName(java.lang.String)">getAttributeGroupName</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#getConcise()">getConcise</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#getConciseAttribute()">getConciseAttribute</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#getConvention()">getConvention</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#getConventionAttribute()">getConventionAttribute</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#getCountAttribute()">getCountAttribute</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#getDictRef()">getDictRef</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#getDictRefAttribute()">getDictRefAttribute</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#getFormalChargeAttribute()">getFormalChargeAttribute</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#getFormulaElements()">getFormulaElements</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#getId()">getId</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#getIdAttribute()">getIdAttribute</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#getInline()">getInline</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#getInlineAttribute()">getInlineAttribute</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#getTitle()">getTitle</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#getTitleAttribute()">getTitleAttribute</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#setConvention(java.lang.String)">setConvention</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#setCount(double)">setCount</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#setDictRef(java.lang.String)">setDictRef</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#setId(java.lang.String)">setId</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#setInline(java.lang.String)">setInline</A>, <A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#setTitle(java.lang.String)">setTitle</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_org.xmlcml.cml.base.CMLElement"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class org.xmlcml.cml.base.<A HREF="../../../../org/xmlcml/cml/base/CMLElement.html" title="class in org.xmlcml.cml.base">CMLElement</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#addNamespaceDeclaration(java.lang.String, java.lang.String)">addNamespaceDeclaration</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#addToLog(org.xmlcml.cml.base.CMLLog.Severity, java.lang.String)">addToLog</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#addToLog(java.lang.Throwable, java.lang.String)">addToLog</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#appendChild(nu.xom.Node)">appendChild</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#compareTo(org.xmlcml.cml.base.CMLElement)">compareTo</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#copyAttributes(org.xmlcml.cml.base.CMLElement)">copyAttributes</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#copyAttributesFromTo(nu.xom.Element, nu.xom.Element)">copyAttributesFromTo</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#copyChildren(org.xmlcml.cml.base.CMLElement)">copyChildren</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#copyNamespaces(org.xmlcml.cml.base.CMLElement)">copyNamespaces</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#copyProperties(org.xmlcml.cml.base.CMLElement)">copyProperties</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#debug()">debug</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#debug(int)">debug</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#debug(java.io.OutputStream, int)">debug</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#debug(java.lang.String)">debug</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#detach()">detach</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#getAncestry()">getAncestry</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#getCanonicalString()">getCanonicalString</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#getChildCMLElement(java.lang.String, int)">getChildCMLElement</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#getChildCMLElements()">getChildCMLElements</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#getChildCMLElements(java.lang.String)">getChildCMLElements</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#getCMLChildCount(java.lang.String)">getCMLChildCount</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#getDescendantCMLElementsById(java.lang.String)">getDescendantCMLElementsById</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#getDescendants()">getDescendants</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#getDescendants(java.lang.String, boolean)">getDescendants</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#getDescendants(java.lang.String, java.lang.String, boolean)">getDescendants</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#getElements(java.lang.String)">getElements</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#getElementsById(java.lang.String, boolean)">getElementsById</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#getFirstCMLChild(java.lang.String)">getFirstCMLChild</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#getNamespaceForPrefix(java.lang.String)">getNamespaceForPrefix</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#getOldestCMLAncestor()">getOldestCMLAncestor</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#getPrefixForNamespace(java.lang.String)">getPrefixForNamespace</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#getProperty(java.lang.String)">getProperty</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#getPropertyNames()">getPropertyNames</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#getStringContent()">getStringContent</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#removeAttribute(java.lang.String)">removeAttribute</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#removeChildren()">removeChildren</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#removeNamespaceDeclaration(java.lang.String)">removeNamespaceDeclaration</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#replaceByChildren()">replaceByChildren</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#replaceChild(nu.xom.Node, nu.xom.Node)">replaceChild</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#resetId(java.lang.String)">resetId</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#serialize(java.io.OutputStream, int)">serialize</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#setAttribute(java.lang.String, java.lang.String)">setAttribute</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#setLocalName(java.lang.String)">setLocalName</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#setLog(org.xmlcml.cml.base.CMLLog)">setLog</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#setNamespacePrefix(java.lang.String)">setNamespacePrefix</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#setNamespaceURI(java.lang.String)">setNamespaceURI</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#setProperty(java.lang.String, java.lang.Object)">setProperty</A>, <A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#setStringContent(java.lang.String)">setStringContent</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_nu.xom.Element"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class nu.xom.Element</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>appendChild, getAttribute, getAttribute, getAttribute, getAttributeCount, getAttributeValue, getAttributeValue, getBaseURI, getChildElements, getChildElements, getChildElements, getFirstChildElement, getFirstChildElement, getLocalName, getNamespaceDeclarationCount, getNamespacePrefix, getNamespacePrefix, getNamespaceURI, getNamespaceURI, getQualifiedName, getValue, insertChild, removeAttribute, setBaseURI, toString, toXML</CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_nu.xom.ParentNode"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class nu.xom.ParentNode</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>getChild, getChildCount, indexOf, insertChild, removeChild, removeChild</CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_nu.xom.Node"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class nu.xom.Node</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>equals, getDocument, getParent, hashCode, query, query</CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>getClass, notify, notifyAll, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="NPLACES"><!-- --></A><H3>
NPLACES</H3>
<PRE>
public static final int <B>NPLACES</B></PRE>
<DL>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../constant-values.html#org.xmlcml.cml.element.CMLFormula.NPLACES">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="NDEC"><!-- --></A><H3>
NDEC</H3>
<PRE>
public static final int <B>NDEC</B></PRE>
<DL>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../constant-values.html#org.xmlcml.cml.element.CMLFormula.NDEC">Constant Field Values</A></DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="CMLFormula()"><!-- --></A><H3>
CMLFormula</H3>
<PRE>
public <B>CMLFormula</B>()</PRE>
<DL>
<DD>normal constructor.
<P>
</DL>
<HR>

<A NAME="CMLFormula(org.xmlcml.cml.element.CMLMolecule)"><!-- --></A><H3>
CMLFormula</H3>
<PRE>
public <B>CMLFormula</B>(<A HREF="../../../../org/xmlcml/cml/element/CMLMolecule.html" title="class in org.xmlcml.cml.element">CMLMolecule</A>&nbsp;molecule)</PRE>
<DL>
<DD>Constructor that creates a formula element using the atoms in a molecule.
 Adds occupancy (default 1.0) to count for each atom Sums charges for
 atoms; if any are non-zero then sets formalCharge as sum. else if
 molecule has formalCharge attribute uses this uses hydrogenCount if not
 null;
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>molecule</CODE> - to analyze
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/xmlcml/cml/base/CMLRuntimeException.html" title="class in org.xmlcml.cml.base">CMLRuntimeException</A></CODE> - if non-CML elements are present</DL>
</DL>
<HR>

<A NAME="CMLFormula(org.xmlcml.cml.element.CMLFormula)"><!-- --></A><H3>
CMLFormula</H3>
<PRE>
public <B>CMLFormula</B>(<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A>&nbsp;old)</PRE>
<DL>
<DD>copy constructor.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>old</CODE> - to copy</DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="copy()"><!-- --></A><H3>
copy</H3>
<PRE>
public nu.xom.Node <B>copy</B>()</PRE>
<DL>
<DD>copy node .
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#copy()">copy</A></CODE> in class <CODE><A HREF="../../../../org/xmlcml/cml/base/CMLElement.html" title="class in org.xmlcml.cml.base">CMLElement</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>Node</DL>
</DD>
</DL>
<HR>

<A NAME="makeElementInContext(nu.xom.Element)"><!-- --></A><H3>
makeElementInContext</H3>
<PRE>
public static <A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A> <B>makeElementInContext</B>(nu.xom.Element&nbsp;parent)</PRE>
<DL>
<DD>create new instance in context of parent, overridable by subclasses.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>parent</CODE> - parent of element to be constructed (ignored by default)
<DT><B>Returns:</B><DD>CMLFormula</DL>
</DD>
</DL>
<HR>

<A NAME="finishMakingElement(nu.xom.Element)"><!-- --></A><H3>
finishMakingElement</H3>
<PRE>
public void <B>finishMakingElement</B>(nu.xom.Element&nbsp;parent)</PRE>
<DL>
<DD>shouldn't be necessary.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#finishMakingElement(nu.xom.Element)">finishMakingElement</A></CODE> in class <CODE><A HREF="../../../../org/xmlcml/cml/base/CMLElement.html" title="class in org.xmlcml.cml.base">CMLElement</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>parent</CODE> - element</DL>
</DD>
</DL>
<HR>

<A NAME="normalize()"><!-- --></A><H3>
normalize</H3>
<PRE>
public void <B>normalize</B>()</PRE>
<DL>
<DD>normalizes the formula.
 <ul>
 <li> if two or more atomArrays are present throws CMLRuntime</li>
 <li> if no concise or atomArray is present does nothing.</li>
 <li> if atomArray is present checks for array format; throws CMLRuntime
 if not.</li>
 <li> if concise but not atomArray is present, generates atomArray. If
 formalCharge is present and in conflict throws CMLRuntime. If non-CML
 elements are present or elements are duplicated, throws CMLRuntime. If
 format is wrong (should have been detected already) throws CMLRuntime</li>
 <li>sorts AtomArray according to CHFIRST</li>
 <li> generates concise including trailing charge and overwrites any
 previous version</li>
 </ul>
<P>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/xmlcml/cml/base/CMLRuntimeException.html" title="class in org.xmlcml.cml.base">CMLRuntimeException</A></CODE> - -
             see above</DL>
</DD>
</DL>
<HR>

<A NAME="checkAtomArrayFormat(org.xmlcml.cml.element.CMLAtomArray)"><!-- --></A><H3>
checkAtomArrayFormat</H3>
<PRE>
public void <B>checkAtomArrayFormat</B>(<A HREF="../../../../org/xmlcml/cml/element/CMLAtomArray.html" title="class in org.xmlcml.cml.element">CMLAtomArray</A>&nbsp;atomArray)</PRE>
<DL>
<DD>checks that atomArray is in array format with unduplicated valid
 elements. must have elementType and count attributes of equal lengths.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>atomArray</CODE> - to check (not modified)
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/xmlcml/cml/base/CMLRuntimeException.html" title="class in org.xmlcml.cml.base">CMLRuntimeException</A></CODE> - if invalid</DL>
</DD>
</DL>
<HR>

<A NAME="generateConcise(org.xmlcml.cml.element.CMLAtomArray, int)"><!-- --></A><H3>
generateConcise</H3>
<PRE>
public static java.lang.String <B>generateConcise</B>(<A HREF="../../../../org/xmlcml/cml/element/CMLAtomArray.html" title="class in org.xmlcml.cml.element">CMLAtomArray</A>&nbsp;atomArray,
                                               int&nbsp;formalCharge)</PRE>
<DL>
<DD>generates concise representation. correponds to concise attribute in
 schema. only works if atomArray has elementType and count in array format
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>atomArray</CODE> - <DD><CODE>formalCharge</CODE> - (maybe omit this)
<DT><B>Returns:</B><DD>concise string
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/xmlcml/cml/base/CMLRuntimeException.html" title="class in org.xmlcml.cml.base">CMLRuntimeException</A></CODE> - if atomArray of wrong sort</DL>
</DD>
</DL>
<HR>

<A NAME="appendChild(nu.xom.Element)"><!-- --></A><H3>
appendChild</H3>
<PRE>
public void <B>appendChild</B>(nu.xom.Element&nbsp;child)</PRE>
<DL>
<DD>add child. must not add atomArray
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>child</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="removeChargeFromConcise(java.lang.String)"><!-- --></A><H3>
removeChargeFromConcise</H3>
<PRE>
public static java.lang.String <B>removeChargeFromConcise</B>(java.lang.String&nbsp;s)</PRE>
<DL>
<DD>removes optional charge field from concise formula. convenience method,
 does not affect CMLormula object.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>s</CODE> - concise string (sssumed to be valid)
<DT><B>Returns:</B><DD>string without trailing charge (does NOT check validity)</DL>
</DD>
</DL>
<HR>

<A NAME="getConciseNoCharge()"><!-- --></A><H3>
getConciseNoCharge</H3>
<PRE>
public java.lang.String <B>getConciseNoCharge</B>()</PRE>
<DL>
<DD>return concise formaul without trailing charge.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>truncated concise (or null)</DL>
</DD>
</DL>
<HR>

<A NAME="setConcise(java.lang.String)"><!-- --></A><H3>
setConcise</H3>
<PRE>
public void <B>setConcise</B>(java.lang.String&nbsp;value)
                throws <A HREF="../../../../org/xmlcml/cml/base/CMLRuntimeException.html" title="class in org.xmlcml.cml.base">CMLRuntimeException</A></PRE>
<DL>
<DD>set concise attribute. if atomArray is absent will automatically compute
 atomArray and formalCharge, so use with care if atomArray is present will
 throw CMLRuntime this logic may need to be revised
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#setConcise(java.lang.String)">setConcise</A></CODE> in class <CODE><A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html" title="class in org.xmlcml.cml.element">AbstractFormula</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>value</CODE> - concise value
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/xmlcml/cml/base/CMLRuntimeException.html" title="class in org.xmlcml.cml.base">CMLRuntimeException</A></CODE> - attribute wrong value/type</DL>
</DD>
</DL>
<HR>

<A NAME="setFormalCharge(int)"><!-- --></A><H3>
setFormalCharge</H3>
<PRE>
public void <B>setFormalCharge</B>(int&nbsp;ch)</PRE>
<DL>
<DD>set formal charge. this will re-compute concise if possible.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#setFormalCharge(int)">setFormalCharge</A></CODE> in class <CODE><A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html" title="class in org.xmlcml.cml.element">AbstractFormula</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>ch</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="createFormula(java.lang.String)"><!-- --></A><H3>
createFormula</H3>
<PRE>
public static <A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A> <B>createFormula</B>(java.lang.String&nbsp;s)
                                throws <A HREF="../../../../org/xmlcml/cml/base/CMLException.html" title="class in org.xmlcml.cml.base">CMLException</A></PRE>
<DL>
<DD>create formula from string. convention defaults to ANY
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>s</CODE> - the String describing the formula
<DT><B>Returns:</B><DD>the CMLFormula derived from the String s
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/xmlcml/cml/base/CMLRuntimeException.html" title="class in org.xmlcml.cml.base">CMLRuntimeException</A></CODE>
<DD><CODE><A HREF="../../../../org/xmlcml/cml/base/CMLException.html" title="class in org.xmlcml.cml.base">CMLException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="createFormula(java.lang.String, org.xmlcml.cml.element.CMLFormula.Type)"><!-- --></A><H3>
createFormula</H3>
<PRE>
public static <A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A> <B>createFormula</B>(java.lang.String&nbsp;s,
                                       <A HREF="../../../../org/xmlcml/cml/element/CMLFormula.Type.html" title="enum in org.xmlcml.cml.element">CMLFormula.Type</A>&nbsp;convention)
                                throws <A HREF="../../../../org/xmlcml/cml/base/CMLException.html" title="class in org.xmlcml.cml.base">CMLException</A></PRE>
<DL>
<DD>create formula from string using convention.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>s</CODE> - the String describing the formula<DD><CODE>convention</CODE> - the convention
<DT><B>Returns:</B><DD>the CMLFormula derived from the String s
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/xmlcml/cml/base/CMLException.html" title="class in org.xmlcml.cml.base">CMLException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="add(java.lang.String, double)"><!-- --></A><H3>
add</H3>
<PRE>
public void <B>add</B>(java.lang.String&nbsp;elementType,
                double&nbsp;count)</PRE>
<DL>
<DD>Adds element and count to formula. If element is already known,
 increments the count.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>elementType</CODE> - the element atomicSymbol<DD><CODE>count</CODE> - the element multiplier</DL>
</DD>
</DL>
<HR>

<A NAME="getCounts()"><!-- --></A><H3>
getCounts</H3>
<PRE>
public double[] <B>getCounts</B>()</PRE>
<DL>
<DD>Count for corresponding element.
 
 No defaults.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>double[] array of element counts; or null for none.</DL>
</DD>
</DL>
<HR>

<A NAME="getElementTypes()"><!-- --></A><H3>
getElementTypes</H3>
<PRE>
public java.lang.String[] <B>getElementTypes</B>()</PRE>
<DL>
<DD>Count for corresponding element.
 
 No defaults.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>double[] array of element counts; or null for none.</DL>
</DD>
</DL>
<HR>

<A NAME="multiplyBy(double)"><!-- --></A><H3>
multiplyBy</H3>
<PRE>
public void <B>multiplyBy</B>(double&nbsp;d)</PRE>
<DL>
<DD>multiply all counts by the same constant factor. this is normally used to
 multiply formula which represent a subfragment of a symmetrical molecule
 it is distinct from the count attribute which represents two of more
 independent entities
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>d</CODE> - to multiply by</DL>
</DD>
</DL>
<HR>

<A NAME="addFormula(org.xmlcml.cml.element.CMLFormula)"><!-- --></A><H3>
addFormula</H3>
<PRE>
public void <B>addFormula</B>(<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A>&nbsp;f)</PRE>
<DL>
<DD>Adds a child formula to the content. if this is empty formula, no action.
 if this has no children, copy this and add as a child, detaching
 atomArray and removing concise from this after that f is copied and
 appended as child
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>f</CODE> - to be copied and added. null is ignored</DL>
</DD>
</DL>
<HR>

<A NAME="getAggregateFormula()"><!-- --></A><H3>
getAggregateFormula</H3>
<PRE>
public <A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A> <B>getAggregateFormula</B>()</PRE>
<DL>
<DD>gets single formula representing all contents.
 
 all formulae are added, using count when present. the current formula is
 not modified can be used for adding separate formula
<P>
<DD><DL>

<DT><B>Returns:</B><DD>composite formula (no formulaVector child)</DL>
</DD>
</DL>
<HR>

<A NAME="createAggregatedFormula(org.xmlcml.cml.element.CMLFormula)"><!-- --></A><H3>
createAggregatedFormula</H3>
<PRE>
public <A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A> <B>createAggregatedFormula</B>(<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A>&nbsp;form)</PRE>
<DL>
<DD>aggregates two formulae including charge.
 
 if either formula is composite, aggregates them first current formula is
 updated to contain aggregate, destroying any structure if no contents,
 uses concise attribute
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>form</CODE> - to aggregate
<DT><B>Returns:</B><DD>formula</DL>
</DD>
</DL>
<HR>

<A NAME="getCount()"><!-- --></A><H3>
getCount</H3>
<PRE>
public double <B>getCount</B>()</PRE>
<DL>
<DD>gets count of formula. defaults to 1.0
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#getCount()">getCount</A></CODE> in class <CODE><A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html" title="class in org.xmlcml.cml.element">AbstractFormula</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>formula count</DL>
</DD>
</DL>
<HR>

<A NAME="divideBy(org.xmlcml.cml.element.CMLFormula, double)"><!-- --></A><H3>
divideBy</H3>
<PRE>
public double <B>divideBy</B>(<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A>&nbsp;f,
                       double&nbsp;eps)</PRE>
<DL>
<DD>divide one formula by another.
 
 requires exactly the same elements are present in each and in the same
 order. 'this' should be the largest formula at present expects the
 results to be integer.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>f</CODE> - formula to divide into 'this'<DD><CODE>eps</CODE> - allowed tolerance between element ratios
<DT><B>Returns:</B><DD>the multiplier (Double.NaN if operation fails)</DL>
</DD>
</DL>
<HR>

<A NAME="getCalculatedMolecularMass()"><!-- --></A><H3>
getCalculatedMolecularMass</H3>
<PRE>
public double <B>getCalculatedMolecularMass</B>()
                                  throws <A HREF="../../../../org/xmlcml/cml/base/CMLRuntimeException.html" title="class in org.xmlcml.cml.base">CMLRuntimeException</A></PRE>
<DL>
<DD>get calculated molecular mass.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>calculated molecular mass.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/xmlcml/cml/base/CMLRuntimeException.html" title="class in org.xmlcml.cml.base">CMLRuntimeException</A></CODE> - unknown/unsupported element type (Dummy counts as zero mass)</DL>
</DD>
</DL>
<HR>

<A NAME="getFormattedString(org.xmlcml.cml.element.CMLFormula.Type, org.xmlcml.cml.element.CMLFormula.Sort, boolean)"><!-- --></A><H3>
getFormattedString</H3>
<PRE>
public java.lang.String <B>getFormattedString</B>(<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.Type.html" title="enum in org.xmlcml.cml.element">CMLFormula.Type</A>&nbsp;convention,
                                           <A HREF="../../../../org/xmlcml/cml/element/CMLFormula.Sort.html" title="enum in org.xmlcml.cml.element">CMLFormula.Sort</A>&nbsp;sort,
                                           boolean&nbsp;omitCount1)
                                    throws <A HREF="../../../../org/xmlcml/cml/base/CMLRuntimeException.html" title="class in org.xmlcml.cml.base">CMLRuntimeException</A></PRE>
<DL>
<DD>Get formatted formula.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>convention</CODE> - <pre>
      NOPUNCTUATION      &quot;C2H4Cl2&quot; (default)
      ELEMENT_COUNT_WHITESPACE &quot;C2 H4 Cl2&quot;
      ELEMENT_WHITESPACE_COUNT &quot;C 2 H 4 Cl 2&quot;
      NESTEDBRACKETS     &quot;(Na2)(SO4).10(H2O)&quot;
 </pre><DD><CODE>sort</CODE> - <pre>
      ALPHABETIC_ELEMENTS    &quot;Br C Cl H&quot;
      CHFIRST      = &quot;C H Br Cl&quot;; (default)
 </pre><DD><CODE>omitCount1</CODE> - omit elements count if 1 (default false)
<DT><B>Returns:</B><DD>String the formatted formula
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/xmlcml/cml/base/CMLRuntimeException.html" title="class in org.xmlcml.cml.base">CMLRuntimeException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getFormalCharge()"><!-- --></A><H3>
getFormalCharge</H3>
<PRE>
public int <B>getFormalCharge</B>()</PRE>
<DL>
<DD>gets the charge on the formula.
 
 if there are child Formulas, iterate through, summing.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html#getFormalCharge()">getFormalCharge</A></CODE> in class <CODE><A HREF="../../../../org/xmlcml/cml/element/AbstractFormula.html" title="class in org.xmlcml.cml.element">AbstractFormula</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>the charge</DL>
</DD>
</DL>
<HR>

<A NAME="getFormalChargeString()"><!-- --></A><H3>
getFormalChargeString</H3>
<PRE>
public java.lang.String <B>getFormalChargeString</B>()</PRE>
<DL>
<DD>translates charge to an integer and then to String.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>charge as a String</DL>
</DD>
</DL>
<HR>

<A NAME="getFormattedString()"><!-- --></A><H3>
getFormattedString</H3>
<PRE>
public java.lang.String <B>getFormattedString</B>()</PRE>
<DL>
<DD>default formula.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>default formula</DL>
</DD>
</DL>
<HR>

<A NAME="getCalculatedMass(java.util.List, org.xmlcml.euclid.RealArray)"><!-- --></A><H3>
getCalculatedMass</H3>
<PRE>
public static double <B>getCalculatedMass</B>(java.util.List&nbsp;elementTypeVector,
                                       <A HREF="../../../../org/xmlcml/euclid/RealArray.html" title="class in org.xmlcml.euclid">RealArray</A>&nbsp;countArray)
                                throws <A HREF="../../../../org/xmlcml/cml/base/CMLException.html" title="class in org.xmlcml.cml.base">CMLException</A></PRE>
<DL>
<DD>Calculate molecular mass from vector of element symbols and their counts.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>countArray</CODE> - <DD><CODE>elementTypeVector</CODE> - 
<DT><B>Returns:</B><DD>mass
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/xmlcml/cml/base/CMLException.html" title="class in org.xmlcml.cml.base">CMLException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="debug(java.io.Writer)"><!-- --></A><H3>
debug</H3>
<PRE>
public void <B>debug</B>(java.io.Writer&nbsp;w)
           throws java.io.IOException</PRE>
<DL>
<DD>Output debug info to Writer.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>w</CODE> - output
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="equals(org.xmlcml.cml.element.CMLFormula, double)"><!-- --></A><H3>
equals</H3>
<PRE>
public boolean <B>equals</B>(<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A>&nbsp;form,
                      double&nbsp;eps)</PRE>
<DL>
<DD>tests equality of formulae. order of elements should be unimportant
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>form</CODE> - to compare with this<DD><CODE>eps</CODE> - tolerance for element counts
<DT><B>Returns:</B><DD>true if formulae are equals</DL>
</DD>
</DL>
<HR>

<A NAME="equalsConcise(org.xmlcml.cml.element.CMLFormula)"><!-- --></A><H3>
equalsConcise</H3>
<PRE>
public boolean <B>equalsConcise</B>(<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A>&nbsp;f)</PRE>
<DL>
<DD>compares current concise strings.
 could fail if strings have decimal points
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>f</CODE> - 
<DT><B>Returns:</B><DD>true if equal</DL>
</DD>
</DL>
<HR>

<A NAME="getDifference(org.xmlcml.cml.element.CMLFormula)"><!-- --></A><H3>
getDifference</H3>
<PRE>
public java.lang.String <B>getDifference</B>(<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A>&nbsp;form)</PRE>
<DL>
<DD>difference between formulas.
 
 formula is difference between this and f on an element by element basis.
 Negative values are used where f has a greater element count that this.
 Zero element counts are ommitted
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>form</CODE> - formula to compare
<DT><B>Returns:</B><DD>difference in concise format (but may contain negative values)</DL>
</DD>
</DL>
<HR>

<A NAME="equalsAggregate(org.xmlcml.cml.element.CMLFormula)"><!-- --></A><H3>
equalsAggregate</H3>
<PRE>
public boolean <B>equalsAggregate</B>(<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.html" title="class in org.xmlcml.cml.element">CMLFormula</A>&nbsp;form)</PRE>
<DL>
<DD>are two formulas equal.
 
 use aggregated formulae as basis
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>form</CODE> - formula to compare
<DT><B>Returns:</B><DD>true if equal</DL>
</DD>
</DL>
<HR>

<A NAME="toFormulaString()"><!-- --></A><H3>
toFormulaString</H3>
<PRE>
public java.lang.String <B>toFormulaString</B>()</PRE>
<DL>
<DD>create formula string.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>the string</DL>
</DD>
</DL>
<HR>

<A NAME="writeHTML(java.io.Writer)"><!-- --></A><H3>
writeHTML</H3>
<PRE>
public void <B>writeHTML</B>(java.io.Writer&nbsp;w)
               throws java.io.IOException</PRE>
<DL>
<DD>output HTML.
<P>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE><A HREF="../../../../org/xmlcml/cml/base/CMLElement.html#writeHTML(java.io.Writer)">writeHTML</A></CODE> in class <CODE><A HREF="../../../../org/xmlcml/cml/base/CMLElement.html" title="class in org.xmlcml.cml.base">CMLElement</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>w</CODE> - 
<DT><B>Throws:</B>
<DD><CODE>java.io.IOException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="mainTest(java.lang.String[])"><!-- --></A><H3>
mainTest</H3>
<PRE>
public static void <B>mainTest</B>(java.lang.String[]&nbsp;args)</PRE>
<DL>
<DD>test. maybe obsolete
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>args</CODE> - </DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/CMLFormula.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/xmlcml/cml/element/CMLFor.html" title="class in org.xmlcml.cml.element"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../org/xmlcml/cml/element/CMLFormula.Sort.html" title="enum in org.xmlcml.cml.element"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?org/xmlcml/cml/element/CMLFormula.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="CMLFormula.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;<A HREF="#nested_class_summary">NESTED</A>&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
